# the bells..
# sonic pi tune

$bells = 8 # number of bells used
$bellPitch = Array[60, 59, 57, 55, 53, 52, 50, 48]
$startPeal = Array(1..$bells)
$peal = $startPeal # holds current order of bells
$vol = 1
puts "#{$peal}" # 'puts' shows current value of array
use_bpm 120

define :hunt do # this swaps adjacent bells except 1st & last
  i = 0
  until i >= $bells
    i += 1
    if i%2 == 0
      k = i -1
      val = $peal.delete_at(i)
      $peal.insert(k, val)
    end
  end
  $peal.compact!
  puts "#{$peal}"
end

define :huntxx do # this swaps all pairs of bells
  i = 0
  until i >= $bells
    i += 1
    if i%2 == 1
      k = i -1
      val = $peal.delete_at(i)
      # puts val
      $peal.insert(k, val)
    end
  end
  $peal.compact!
  puts "#{$peal}"
end

define :playBell do |b|
  use_synth :dull_bell # probably can find a better sound for this
  play b, amp: $vol
end

define :playRing do # plays 8 bells in current order
  $bells.times do |i|
    place = $peal.at(i)
    pitch = $bellPitch.at(place-1)
    playBell pitch
    sleep 1
  end
  sleep 1
end


8.times do # start of actual playing loop
  playRing
  hunt
  playRing
  huntxx
end
playRing
